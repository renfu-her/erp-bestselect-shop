<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class productDisaledSeed extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        //
        // 1
        $id1 = [216, 217, 218, 557, 558, 559, 564, 565, 567, 568, 569, 570, 571, 572, 573, 575, 580, 589, 592, 594, 618, 619, 620, 621, 623, 629, 631, 633, 639, 650, 652, 655, 848, 892, 894, 895, 898, 910, 911, 912, 986, 1066, 1080, 1081, 1083, 1084, 1085, 1093, 1094, 1095, 1096, 1110, 1185, 1187, 1193, 1195, 1197, 1261, 1324, 1325, 1363, 1370, 1405, 1426, 1427, 1428, 1615, 1618, 1619, 1621, 1630, 1728, 1729, 1911, 2166, 2225, 2424, 2459, 2475, 2929, 2948, 2949, 2950, 2951, 2952, 2953, 2954, 2956, 2957, 2959, 2961, 2962, 2965, 2966, 2968, 2969, 2972, 2973, 2983, 2984, 2985, 2986, 2989, 2990, 2991, 2992, 3033, 3047, 3053, 3054, 3059, 3062, 3064, 3065, 3066, 3067, 3361, 3463, 3612, 3613, 3614, 3615, 3616, 3617, 3665, 3666, 3667, 3669, 3709, 3710, 3711, 3718, 3720, 3721, 3725, 3728, 3730, 3732, 3739, 3742, 3750, 3752, 3753, 3755, 3760, 3762, 3763, 3764, 3765, 3766, 3781, 3787, 3788, 3789, 3790, 3791, 3792, 3793, 3795, 3796, 3915, 4207, 4248, 4249];
        //
        DB::table('prd_products')->whereIn('id', $id1)->update(['public' => 1]);

        $id0 = [504, 507, 509, 511, 516, 517, 518, 519, 522, 523, 525, 530, 531, 533, 537, 538, 539, 540, 541, 561, 563, 654, 764, 835, 836, 837, 1079, 1097, 1208, 1277, 1296, 1301, 1302, 1303, 1431, 1432, 1434, 1435, 1436, 1437, 1940, 1941, 1942, 1943, 1944, 1947, 1948, 1951, 2222, 2249, 2252, 2258, 2405, 2436, 2437, 2438, 2481, 2482, 2800, 2955, 2958, 2960, 3030, 3032, 3046, 3055, 3083, 3221, 3222, 3223, 3225, 3226, 3227, 3234, 3235, 3236, 3237, 3238, 3239, 3240, 3243, 3244, 3245, 3246, 3247, 3248, 3249, 3250, 3251, 3252, 3253, 3254, 3255, 3256, 3257, 3258, 3259, 3260, 3261, 3262, 3263, 3264, 3265, 3266, 3267, 3269, 3270, 3271, 3272, 3273, 3274, 3275, 3276, 3277, 3278, 3282, 3284, 3285, 3286, 3287, 3288, 3289, 3290, 3291, 3293, 3294, 3295, 3296, 3297, 3298, 3300, 3301, 3302, 3303, 3304, 3306, 3307, 3308, 3311, 3313, 3314, 3315, 3316, 3331, 3335, 3336, 3339, 3340, 3358, 3359, 3360, 3362, 3363, 3364, 3365, 3366, 3367, 3368, 3370, 3371, 3372, 3375, 3380, 3399, 3410, 3411, 3568, 3605, 3606, 3607, 3608, 3609, 3610, 3611, 3618, 3619, 3620, 3621, 3622, 3624, 3625, 3626, 3650, 3652, 3653, 3655, 3712, 3713, 3716, 3717, 3719, 3722, 3723, 3724, 3726, 3729, 3731, 3734, 3735, 3736, 3737, 3738, 3740, 3741, 3743, 3744, 3745, 3746, 3748, 3761, 3767, 3782];
        DB::table('prd_products')->whereIn('id', $id0)->update(['public' => 0]);

        exit;

        $sup = ["台塑生醫", "合益", "奇華", "養泉", "耐嘉", "祥和", "大鼎", "十翼饌"
            , "八木", "匯恩", "王瓊凰", "黃源財", "李寶輝", "童林"];

        $re = DB::table('prd_suppliers as supplier')
            ->leftJoin('prd_product_supplier as ps', 'supplier.id', '=', 'ps.supplier_id')
            ->select(['ps.product_id'])
            ->whereNotNull('ps.product_id')
            ->where(function ($query) use ($sup) {
                $query->where('supplier.name', 'like', "%" . $sup[0] . "%");
                for ($i = 1; $i < count($sup); $i++) {
                    $query->orWhere('supplier.name', 'like', "%" . $sup[$i] . "%");
                }
            })->get()->toArray();

        $pp = DB::table('prd_products')
            ->select('id', 'sku', 'public')
            ->where('public', '0')
            ->whereIn('id', array_map(function ($n) {
                return $n->product_id;
            }, $re)); //->update(['public' => 1]);

        dd(json_encode(array_map(function ($n) {
            return $n->id;
        }, $pp->get()->toArray())));
    }
}
